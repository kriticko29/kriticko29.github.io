---
layout: post
title: "Abusing Legacy Vulnerabilities for Modern Malware Delivery: CVE-2017-8570 & Masslogger"
date: 2025-07-30 20:45:00 +0800
background: '/img/posts/office-exploit.jpg'
---

<h2>Introduction</h2>

<p>In today's post-exploit world, threat actors often recycle legacy vulnerabilities to deliver modern payloads with devastating efficiency. One such example is <strong>CVE-2017-8570</strong>, a vulnerability affecting Microsoft Office that allows for remote code execution via specially crafted OLE objects embedded in Word documents. Despite being patched years ago, it remains actively exploited in phishing campaigns due to its effectiveness and compatibility with older Office versions still in use across enterprise networks.</p>

<p>In this blog entry, Iâ€™ll demonstrate how CVE-2017-8570 was leveraged in a recent attack to deliver <strong>Masslogger</strong>, a credential-harvesting trojan known for its evasive techniques and multi-stage infection chain. This analysis walks through the infection vector, document behavior, embedded payloads, and post-exploitation activityâ€”all the way to credential exfiltration.</p>

<h2 class="section-heading">Technical Analysis</h2>

<p>The attack began with an email attachment masquerading as a time-sensitive invoice, using social engineering to lure the recipient into opening the document. The email subject line claimed urgency â€” while the attachment itself was innocuously named with a numerical string like <code>"980123.docx"</code> to blend in with typical office documents, designed to appear routine and credible to the unsuspecting user.</p>

<p>Upon opening the document, the victim is shown a dummy invoice containing vague figures or placeholder text meant to delay suspicion.</p>

<p><em>&lt;screenshot 2: Opened document showing fake invoice content&gt;</em></p>

<p>On the surface, the document appears harmless, but beneath the UI, it triggers a silent exploit process that does not require any additional user interaction. As observed through network monitoring, the document immediately reaches out to a malicious command-and-control (C2) server upon opening. In this case, the outbound connection was made to:</p>

<p><code>&lt;insert ioc website&gt;</code></p>

<p><em>&lt;screenshot 3: Network capture showing HTTP or TCP connection to C2&gt;</em></p>

<p>A deeper inspection of the document reveals that it was crafted to exploit <strong>CVE-2017-8570</strong>, which targets the way Microsoft Office handles external relationships defined in OOXML-based documents. Specifically, the malicious <code>.docx</code> file contains a manipulated <code>settings.xml.rels</code> file that references a remotely hosted RTF payload. This remote reference abuses Officeâ€™s ability to load external templates or settings files, causing the application to silently fetch and open the malicious RTF upon document launch.</p>

<p><em>&lt;screenshot 4: settings.xml.rels content showing external reference to malicious RTF&gt;</em></p>

<p>This technique allows attackers to stage their payloadsâ€”delivering a seemingly benign document that downloads the actual exploit content dynamically. In this case, the downloaded RTF later triggers <strong>CVE-2017-11882</strong>, leveraging the legacy Equation Editor for remote code execution. Since the initial download is handled natively by Microsoft Word and uses legitimate Office XML structures, this technique remains stealthy and difficult to detect using conventional static analysis.</p>

<p><em>&lt;Insert eqnedt32 screenshot (5)&gt;</em></p>

<p>The shellcode is engineered to retrieve and execute additional malicious code directly from a remote server, operating entirely in memory to evade detection.</p>

<p><em>&lt;Insert network activity screenshot (6)&gt;</em></p>

<p>This fileless technique enables the seamless deployment of the final payloadâ€”<strong>Masslogger</strong>, a credential-stealing malware known for targeting browser data, email credentials, and VPN configurations.</p>

<p>ðŸ“Ž For an in-depth technical analysis of Massloggerâ€™s functionality and tactics, see the full report: <a href="https://tinextadefence.it/wp-content/uploads/2025/06/Report-MassLogger.pdf" target="_blank"><strong>Masslogger Malware Analysis â€“ Tinexta Defence (PDF)</strong></a></p>
